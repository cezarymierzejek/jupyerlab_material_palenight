!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@lumino/commands"),require("@lumino/coreutils"),require("@lumino/widgets")):"function"==typeof define&&define.amd?define(["exports","@lumino/commands","@lumino/coreutils","@lumino/widgets"],t):t((e=e||self).lumino_application={},e.lumino_commands,e.lumino_coreutils,e.lumino_widgets)}(this,(function(e,t,r,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var n,o=function(){function e(e){this._started=!1,this._pluginMap=n.createPluginMap(),this._serviceMap=n.createServiceMap(),this._delegate=new r.PromiseDelegate;var o=new t.CommandRegistry,s=e.contextMenuRenderer,a=new i.ContextMenu({commands:o,renderer:s});this.commands=o,this.contextMenu=a,this.shell=e.shell}return Object.defineProperty(e.prototype,"started",{get:function(){return this._delegate.promise},enumerable:!0,configurable:!0}),e.prototype.hasPlugin=function(e){return e in this._pluginMap},e.prototype.listPlugins=function(){return Object.keys(this._pluginMap)},e.prototype.registerPlugin=function(e){if(e.id in this._pluginMap)throw new Error("Plugin '"+e.id+"' is already registered.");var t=n.createPluginData(e);n.ensureNoCycle(t,this._pluginMap,this._serviceMap),t.provides&&this._serviceMap.set(t.provides,t.id),this._pluginMap[t.id]=t},e.prototype.registerPlugins=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this.registerPlugin(i)}},e.prototype.activatePlugin=function(e){var t=this,r=this._pluginMap[e];if(!r)return Promise.reject(new Error("Plugin '"+e+"' is not registered."));if(r.activated)return Promise.resolve(void 0);if(r.promise)return r.promise;var i=r.requires.map((function(e){return t.resolveRequiredService(e)})),n=r.optional.map((function(e){return t.resolveOptionalService(e)})),o=i.concat(n);return r.promise=Promise.all(o).then((function(e){return r.activate.apply(void 0,function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i}([t],e))})).then((function(e){r.service=e,r.activated=!0,r.promise=null})).catch((function(e){throw r.promise=null,e})),r.promise},e.prototype.resolveRequiredService=function(e){var t=this._serviceMap.get(e);if(!t)return Promise.reject(new Error("No provider for: "+e.name+"."));var r=this._pluginMap[t];return r.activated?Promise.resolve(r.service):this.activatePlugin(t).then((function(){return r.service}))},e.prototype.resolveOptionalService=function(e){var t=this._serviceMap.get(e);if(!t)return Promise.resolve(null);var r=this._pluginMap[t];return r.activated?Promise.resolve(r.service):this.activatePlugin(t).then((function(){return r.service})).catch((function(e){return console.error(e),null}))},e.prototype.start=function(e){var t=this;if(void 0===e&&(e={}),this._started)return this._delegate.promise;this._started=!0;var r=e.hostID||"",i=n.collectStartupPlugins(this._pluginMap,e).map((function(e){return t.activatePlugin(e).catch((function(t){console.error("Plugin '"+e+"' failed to activate."),console.error(t)}))}));return Promise.all(i).then((function(){t.attachShell(r),t.addEventListeners(),t._delegate.resolve(void 0)})),this._delegate.promise},e.prototype.handleEvent=function(e){switch(e.type){case"resize":this.evtResize(e);break;case"keydown":this.evtKeydown(e);break;case"contextmenu":this.evtContextMenu(e)}},e.prototype.attachShell=function(e){i.Widget.attach(this.shell,e&&document.getElementById(e)||document.body)},e.prototype.addEventListeners=function(){document.addEventListener("contextmenu",this),document.addEventListener("keydown",this,!0),window.addEventListener("resize",this)},e.prototype.evtKeydown=function(e){this.commands.processKeydownEvent(e)},e.prototype.evtContextMenu=function(e){e.shiftKey||this.contextMenu.open(e)&&(e.preventDefault(),e.stopPropagation())},e.prototype.evtResize=function(e){this.shell.update()},e}();!function(e){e.createPluginMap=function(){return Object.create(null)},e.createServiceMap=function(){return new Map},e.createPluginData=function(e){return{id:e.id,service:null,promise:null,activated:!1,activate:e.activate,provides:e.provides||null,autoStart:e.autoStart||!1,requires:e.requires?e.requires.slice():[],optional:e.optional?e.optional.slice():[]}},e.ensureNoCycle=function(e,t,r){var i=e.requires.concat(e.optional);if(e.provides&&0!==i.length){var n=[e.id];if(i.some((function i(o){if(o===e.provides)return!0;var s=r.get(o);if(!s)return!1;var a=t[s],u=a.requires.concat(a.optional);if(0===u.length)return!1;if(n.push(s),u.some(i))return!0;return n.pop(),!1})))throw new Error("Cycle detected: "+n.join(" -> ")+".")}},e.collectStartupPlugins=function(e,t){var r=Object.create(null);for(var i in e)e[i].autoStart&&(r[i]=!0);if(t.startPlugins)for(var n=0,o=t.startPlugins;n<o.length;n++){r[i=o[n]]=!0}if(t.ignorePlugins)for(var s=0,a=t.ignorePlugins;s<a.length;s++){delete r[i=a[s]]}return Object.keys(r)}}(n||(n={})),e.Application=o,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.min.js.map